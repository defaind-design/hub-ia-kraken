<div class="bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 shadow-lg">
  <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">
    Create New Kraken Session
  </h2>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-6">
    <!-- Prompt Input -->
    <div>
      <label for="prompt" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
        Your Prompt to Kraken *
      </label>
      <textarea
        id="prompt"
        formControlName="prompt"
        rows="4"
        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"
        placeholder="Ask Kraken anything... e.g., 'Kraken, reporte seu status operacional agora.'"
      ></textarea>
      
      <div *ngIf="prompt?.invalid && (prompt?.touched || prompt?.dirty)" class="mt-2 text-sm text-red-600">
        <div *ngIf="prompt?.errors?.['required']">Prompt is required</div>
        <div *ngIf="prompt?.errors?.['minlength']">Prompt must be at least 3 characters</div>
      </div>
    </div>

    <!-- Session ID -->
    <div>
      <label for="sessionId" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
        Session ID *
      </label>
      <input
        type="text"
        id="sessionId"
        formControlName="sessionId"
        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"
        placeholder="e.g., test-session-001"
      >
      <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
        Unique identifier for this session. Leave as-is for testing.
      </p>
    </div>

    <!-- Organization ID -->
    <div>
      <label for="organizationId" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
        Organization ID *
      </label>
      <input
        type="text"
        id="organizationId"
        formControlName="organizationId"
        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"
        placeholder="e.g., org-pablo-astrologia"
      >
    </div>

    <!-- User ID -->
    <div>
      <label for="userId" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
        User ID *
      </label>
      <input
        type="text"
        id="userId"
        formControlName="userId"
        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"
        placeholder="e.g., pablo-admin"
      >
    </div>

    <!-- Response Message -->
    <div *ngIf="responseMessage" class="p-4 rounded-lg" [ngClass]="{
      'bg-green-50 border border-green-200 text-green-800': responseType === 'success',
      'bg-red-50 border border-red-200 text-red-800': responseType === 'error'
    }">
      <div class="flex items-start">
        <div class="flex-shrink-0">
          <span *ngIf="responseType === 'success'" class="text-green-600">✅</span>
          <span *ngIf="responseType === 'error'" class="text-red-600">❌</span>
        </div>
        <div class="ml-3">
          <p class="text-sm font-medium">{{ responseMessage }}</p>
        </div>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="flex items-center justify-between pt-4">
      <div class="text-sm text-gray-500 dark:text-gray-400">
        <p>This will trigger the Kraken Cloud Function and create a new session in Firestore.</p>
      </div>
      
      <button
        type="submit"
        [disabled]="isSubmitting || form.invalid"
        class="px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold rounded-lg shadow-md transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
      >
        <span *ngIf="isSubmitting" class="animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"></span>
        {{ isSubmitting ? 'Creating Session...' : 'Create Session' }}
      </button>
    </div>
  </form>

  <!-- Help Text -->
  <div class="mt-8 pt-6 border-t border-gray-200 dark:border-gray-700">
    <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-3">How it works:</h3>
    <ul class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
      <li class="flex items-start gap-2">
        <span class="text-blue-500">1.</span>
        <span>Enter your prompt and session details above</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-blue-500">2.</span>
        <span>Click "Create Session" to trigger the Kraken Cloud Function</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-blue-500">3.</span>
        <span>The function will process your request and stream responses to Firestore</span>
      </li>
      <li class="flex items-start gap-2">
        <span class="text-blue-500">4.</span>
        <span>Watch the Session Viewer below for real-time updates</span>
      </li>
    </ul>
  </div>
</div>